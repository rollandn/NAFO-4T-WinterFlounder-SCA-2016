# Prepare data structure for TMB population model:

data <- list()
data$years <- 1973:2016
data$n_year <- length(data$years) # Number of years in analysis.
       
# Fishery total landings in MT by year (1973-2016):
data$C <- c(2300,1920,2010,2407,1235,1121,1585,1976,1941,2305,1799,149,1180,2044,
            1811,1414,2089,2077,2536.2,1892.9,1664.9,1237,668,836.1,1129,620.7,647.5,
            576.7,573.3,440.2,468.3,381.5,383.4,246.7,192.7,197.4,209.7,301.3,317.7,
            305.9,210.9,191.9,215.9, 191.9)
names(data$C) <- data$years

# Mean individual catch weights (in kg) by year and size group (1973-2016):
data$Cw <- cbind(c(0.1487,0.1487,0.1438,0.144,0.1354,0.1046,0.1368,0.1602,0.1697,0.1467,0.1184,
                   0.1472,0.1458,0.1547,0.1478,0.151,0.1583,0.1787,0.1771,0.1429,0.1633,0.1455,
                   0.1566,0.1527,0.1423,0.1576,0.1569,0.1391,0.1423,0.1346,0.1529,0.153,0.1437,
                   0.1455,0.13,0.1152,0.1342,0.1022,0.1052,0.1146,0.1177,0.1356,0.1193, 0.1239),
                 c(0.4639,0.4546,0.3723,0.3464,0.3346,0.3192,0.2633,0.3026,0.3094,0.321,0.3267,
                   0.2846,0.4753,0.3978,0.3359,0.301,0.3734,0.353,0.2375,0.3527,0.2853,0.3221,
                   0.3771,0.3515,0.3098,0.3289,0.3268,0.3279,0.3233,0.3115,0.2887,0.3079,0.278,
                   0.2861,0.2839,0.2917,0.2865,0.2825,0.2559,0.2772,0.2967,0.3005,0.3264, 0.2961))
dimnames(data$Cw) <- list(year = data$years, group = 1:2)

# Survey abundance (offshore) by year and size group (in thousands):
data$I_rv <- cbind(c(2088.6,2424,10243.3,32610,9195.8,94882,22404.6,26837.1,21869.5,29279.4,28623.5,11737.9,
                     33571.5,14655.1,18827,33361.2,20882,22524.7,41988.3,62035.6,41949.5,46697.6,27579,20330.8,
                     79691.9,34444.1,41002.2,34871.5,50323.8,61580.5,36347.3,49908.4,42117.8,45235.5,72462.8,
                     35101,34632.7,28400.4,59270.6,35688,15774,11956.3,16216.7,28044.3,16373.9,15366.3),
                   c(31138.6,35778.2,26340.8,104510.7,49186.6,167043.6,18222,73885.5,41084.1,79304.9,71260.5,
                     56167.7,85336.4,18863.1,25807,36877.5,14375.7,28066.4,35496.3,31064,20265,31003,29255.7,
                     16832,20113.8,20292.8,17411.7,10830.7,26547.8,23337.8,17151.1,31129.2,15377.1,18705,17364.9,
                     14908.3,13242.1,10105.9,14297.4,9615.7,6805.7,4109.1,8631.2,5380.3,6519,2817.8))
rownames(data$I_rv) <- 1971:2016
data$I_rv <- data$I_rv[as.numeric(rownames(data$I_rv)) %in% data$years,]
colnames(data$I_rv) <- 1:2

# Trawlable biomass of RV survey in MT (stratum 415-439):
data$B_rv <- c(12010.9,14752.8,11164,49838.4,21169,77319.3,8429,26459.6,14682.6,28672.7,27729.2,
               19261.4,28636.8,8579.8,10459.3,16821.3,6571.6,11369.4,15403.6,16248.1,10186.1,
               14653.2,11249.3,6876.1,11661,8921.5,7931.9,6447.2,12039.1,11486.3,7954.6,14013.1,
               7655.7,9218.7,8971.5,6948.2,6962.8,5100.2,8086.2,5656.5,3073.1,2117.9,3624.7,3423.5,
               3115.4,1930.1)
names(data$B_rv) <- 1971:2016
data$B_rv <- data$B_rv[as.numeric(names(data$B_rv)) %in% data$years]

# Survey index individual mean weights (in kg) by year and size group:
data$Iw_rv <- cbind(c(0.1409,0.1425,0.1231,0.0759,0.1358,0.1463,0.1224,0.1379,0.1021,0.1302,0.1097,0.1382,0.1023,0.1047,0.1155,
                      0.1155,0.1051,0.1175,0.124,0.1262,0.1316,0.1234,0.1215,0.0938,0.0682,0.0871,0.0809,0.097,0.0986,0.0862,
                      0.092,0.0816,0.0783,0.0937,0.0627,0.0832,0.0836,0.0869,0.0717,0.0861,0.089,0.091,0.0821,0.0721,0.0771,0.0774),
                    c(0.3763,0.4027,0.376,0.4532,0.405,0.3798,0.3121,0.308,0.3031,0.3135,0.345,0.314,0.2953,0.3735,0.3211,0.3516,
                      0.306,0.3108,0.2873,0.2711,0.2302,0.2868,0.27,0.2952,0.3095,0.2917,0.2649,0.2828,0.2666,0.2647,0.2689,0.3194,
                      0.2834,0.2662,0.2548,0.2701,0.3072,0.2606,0.2684,0.2686,0.2452,0.2507,0.2658,0.2605,0.2843,0.2628))
rownames(data$Iw_rv) <- 1971:2016
data$Iw_rv <- data$Iw_rv[as.numeric(rownames(data$Iw_rv)) %in% data$years,]
colnames(data$Iw_rv) <- 1:2

# Survey population proportions-at-age (strata 415-439):
data$P_rv = structure(
    .Data = c(0.0000, 0.0004, 0.0083, 0.0495, 0.1284, 0.2112, 0.2309, 0.1909, 0.0994, 0.0461, 0.0204, 0.0112, 0.0029, 0.0005, 
              0.0000, 0.0011, 0.0091, 0.0494, 0.1208, 0.2007, 0.2351, 0.1941, 0.1029, 0.0488, 0.0219, 0.0122, 0.0031, 0.0006, 
              0.0010, 0.0098, 0.0552, 0.1450, 0.1741, 0.1843, 0.1825, 0.1292, 0.0635, 0.0304, 0.0141, 0.0083, 0.0022, 0.0005, 
              0.0084, 0.0773, 0.0809, 0.0769, 0.1057, 0.1478, 0.1942, 0.1483, 0.0809, 0.0427, 0.0208, 0.0125, 0.0030, 0.0009, 
              0.0000, 0.0019, 0.0207, 0.1385, 0.1628, 0.2142, 0.2006, 0.1362, 0.0650, 0.0328, 0.0136, 0.0098, 0.0033, 0.0004, 
              0.0000, 0.0058, 0.0588, 0.1845, 0.2270, 0.1778, 0.1560, 0.0960, 0.0456, 0.0240, 0.0124, 0.0078, 0.0024, 0.0017, 
              0.0001, 0.0108, 0.0997, 0.2080, 0.3027, 0.1648, 0.1040, 0.0562, 0.0384, 0.0091, 0.0039, 0.0019, 0.0004, 0.0001, 
              0.0000, 0.0010, 0.0247, 0.1176, 0.2359, 0.3374, 0.1351, 0.0820, 0.0257, 0.0226, 0.0113, 0.0051, 0.0013, 0.0003, 
              0.0000, 0.0036, 0.0808, 0.1402, 0.2250, 0.2072, 0.1745, 0.1022, 0.0363, 0.0165, 0.0072, 0.0052, 0.0011, 0.0002, 
              0.0000, 0.0015, 0.0374, 0.1344, 0.1776, 0.2141, 0.2171, 0.1651, 0.0287, 0.0131, 0.0069, 0.0030, 0.0008, 0.0003, 
              0.0014, 0.0224, 0.0757, 0.1301, 0.1788, 0.1768, 0.1982, 0.1075, 0.0575, 0.0256, 0.0165, 0.0064, 0.0018, 0.0013, 
              0.0000, 0.0019, 0.0184, 0.0914, 0.2543, 0.2294, 0.1783, 0.1141, 0.0546, 0.0289, 0.0150, 0.0069, 0.0014, 0.0054, 
              0.0001, 0.0068, 0.0502, 0.1169, 0.1831, 0.2207, 0.1964, 0.1264, 0.0629, 0.0234, 0.0085, 0.0037, 0.0008, 0.0002, 
              0.0072, 0.0296, 0.0970, 0.1527, 0.1775, 0.1637, 0.1408, 0.1089, 0.0676, 0.0326, 0.0133, 0.0071, 0.0018, 0.0003, 
              0.0015, 0.0307, 0.0955, 0.1518, 0.2105, 0.2024, 0.1500, 0.0929, 0.0406, 0.0149, 0.0057, 0.0026, 0.0007, 0.0001, 
              0.0009, 0.0222, 0.1049, 0.1858, 0.2135, 0.1805, 0.1353, 0.0889, 0.0414, 0.0163, 0.0065, 0.0030, 0.0007, 0.0002, 
              0.0009, 0.0227, 0.1258, 0.2363, 0.2408, 0.1598, 0.1034, 0.0632, 0.0286, 0.0113, 0.0045, 0.0020, 0.0004, 0.0001, 
              0.0005, 0.0133, 0.0761, 0.1929, 0.2484, 0.1881, 0.1350, 0.0842, 0.0380, 0.0145, 0.0057, 0.0024, 0.0005, 0.0002, 
              0.0001, 0.0091, 0.0811, 0.2526, 0.3012, 0.1734, 0.0994, 0.0497, 0.0201, 0.0079, 0.0032, 0.0016, 0.0004, 0.0001, 
              0.0022, 0.0190, 0.1019, 0.3091, 0.3284, 0.1326, 0.0679, 0.0294, 0.0073, 0.0010, 0.0010, 0.0003, 0.0001, 0.0001, 
              0.0010, 0.0418, 0.1272, 0.2839, 0.2559, 0.1418, 0.0826, 0.0464, 0.0149, 0.0033, 0.0004, 0.0008, 0.0000, 0.0000, 
              0.0005, 0.0306, 0.1648, 0.2380, 0.2359, 0.1709, 0.0961, 0.0387, 0.0164, 0.0058, 0.0016, 0.0007, 0.0001, 0.0000, 
              0.0030, 0.0290, 0.1314, 0.1887, 0.1993, 0.1905, 0.1054, 0.0792, 0.0424, 0.0229, 0.0041, 0.0018, 0.0010, 0.0012, 
              0.0216, 0.0785, 0.1438, 0.1729, 0.2002, 0.1732, 0.1009, 0.0662, 0.0287, 0.0096, 0.0029, 0.0011, 0.0002, 0.0002, 
              0.0357, 0.1653, 0.2915, 0.1892, 0.1298, 0.0858, 0.0505, 0.0322, 0.0133, 0.0043, 0.0014, 0.0007, 0.0002, 0.0001, 
              0.0111, 0.0684, 0.1910, 0.2013, 0.1926, 0.1456, 0.0932, 0.0593, 0.0247, 0.0079, 0.0030, 0.0015, 0.0004, 0.0001, 
              0.0087, 0.0744, 0.2203, 0.2239, 0.1983, 0.1313, 0.0796, 0.0419, 0.0145, 0.0040, 0.0023, 0.0008, 0.0000, 0.0000, 
              0.0030, 0.0608, 0.2202, 0.2480, 0.2080, 0.1330, 0.0742, 0.0346, 0.0127, 0.0037, 0.0013, 0.0005, 0.0001, 0.0000, 
              0.0040, 0.0593, 0.1692, 0.2167, 0.2219, 0.1635, 0.0960, 0.0469, 0.0161, 0.0044, 0.0015, 0.0005, 0.0001, 0.0000, 
              0.0108, 0.0729, 0.1996, 0.1983, 0.2044, 0.1393, 0.0837, 0.0644, 0.0194, 0.0047, 0.0018, 0.0006, 0.0001, 0.0000, 
              0.0040, 0.0551, 0.1766, 0.2024, 0.2103, 0.1555, 0.0939, 0.0697, 0.0227, 0.0062, 0.0024, 0.0009, 0.0002, 0.0001, 
              0.0095, 0.0750, 0.1834, 0.1712, 0.1647, 0.1397, 0.0996, 0.0895, 0.0412, 0.0159, 0.0068, 0.0027, 0.0005, 0.0002, 
              0.0076, 0.0953, 0.2202, 0.2010, 0.1760, 0.1306, 0.0745, 0.0573, 0.0237, 0.0087, 0.0036, 0.0012, 0.0002, 0.0002, 
              0.0024, 0.0456, 0.1412, 0.2155, 0.2209, 0.1770, 0.0853, 0.0728, 0.0243, 0.0088, 0.0040, 0.0011, 0.0001, 0.0010, 
              0.0221, 0.1276, 0.2807, 0.1790, 0.1353, 0.1214, 0.0642, 0.0420, 0.0175, 0.0072, 0.0012, 0.0018, 0.0001, 0.0000, 
              0.0029, 0.0314, 0.1454, 0.2187, 0.1990, 0.1443, 0.1004, 0.0837, 0.0484, 0.0138, 0.0080, 0.0030, 0.0009, 0.0000, 
              0.0041, 0.0275, 0.1562, 0.1847, 0.2185, 0.1702, 0.0983, 0.0584, 0.0502, 0.0206, 0.0082, 0.0029, 0.0002, 0.0000, 
              0.0035, 0.0639, 0.1669, 0.1901, 0.2178, 0.1648, 0.0934, 0.0568, 0.0284, 0.0093, 0.0035, 0.0013, 0.0002, 0.0001, 
              0.0078, 0.1243, 0.2583, 0.1999, 0.1601, 0.1105, 0.0653, 0.0451, 0.0198, 0.0060, 0.0022, 0.0007, 0.0001, 0.0000, 
              0.0033, 0.0677, 0.1995, 0.2338, 0.1998, 0.1314, 0.0740, 0.0560, 0.0228, 0.0075, 0.0028, 0.0011, 0.0002, 0.0000, 
              0.0117, 0.0782, 0.1617, 0.1954, 0.1799, 0.1456, 0.0950, 0.0870, 0.0315, 0.0093, 0.0033, 0.0011, 0.0002, 0.0000, 
              0.0054, 0.0664, 0.1915, 0.2824, 0.2392, 0.1139, 0.0594, 0.0275, 0.0096, 0.0030, 0.0011, 0.0004, 0.0001, 0.0000, 
              0.0169, 0.0702, 0.1927, 0.2550, 0.2186, 0.1176, 0.0744, 0.0354, 0.0131, 0.0040, 0.0015, 0.0005, 0.0001, 0.0001, 
              0.0214, 0.1587, 0.2629, 0.2433, 0.1601, 0.0835, 0.0426, 0.0190, 0.0060, 0.0015, 0.0005, 0.0002, 0.0000, 0.0001, 
              0.0103, 0.1353, 0.2374, 0.1781, 0.1516, 0.1066, 0.0634, 0.0678, 0.0314, 0.0109, 0.0048, 0.0019, 0.0004, 0.0001, 
              0.0239, 0.1340, 0.2611, 0.2269, 0.1668, 0.0882, 0.0430, 0.0350, 0.0140, 0.0045, 0.0018, 0.0006, 0.0001, 0.0000), 
    .Dim = c(14,46))
data$P_rv <- t(data$P_rv)    
data$P_rv <- data$P_rv / repvec(apply(data$P_rv, 1, sum), ncol = ncol(data$P_rv))
dimnames(data$P_rv) <- list(year = 1971:2016, age = 1:14)

# Fishery catch proportions-at-age (from numbers):
data$P_fishery =
structure(
    .Data = c(0.0000, 0.0000, 0.0002, 0.0146, 0.0763, 0.1812, 0.2541, 0.2138, 0.1230, 0.0693, 0.0342, 0.0244, 0.0075, 0.0013, 
              0.0000, 0.0007, 0.0101, 0.0548, 0.1190, 0.1964, 0.2495, 0.1767, 0.0915, 0.0503, 0.0255, 0.0186, 0.0056, 0.0012, 
              0.0000, 0.0005, 0.0104, 0.1317, 0.1701, 0.2319, 0.2097, 0.1377, 0.0623, 0.0270, 0.0108, 0.0062, 0.0017, 0.0003, 
              0.0000, 0.0038, 0.0405, 0.1504, 0.2349, 0.2064, 0.1754, 0.1013, 0.0448, 0.0223, 0.0113, 0.0061, 0.0014, 0.0014, 
              0.0000, 0.0027, 0.0302, 0.1020, 0.2508, 0.2145, 0.1854, 0.1137, 0.0656, 0.0207, 0.0089, 0.0044, 0.0010, 0.0002, 
              0.0000, 0.0098, 0.0859, 0.1582, 0.1946, 0.2951, 0.1233, 0.0744, 0.0225, 0.0207, 0.0100, 0.0041, 0.0011, 0.0002, 
              0.0000, 0.0000, 0.0000, 0.0511, 0.2266, 0.2848, 0.2378, 0.1408, 0.0413, 0.0108, 0.0044, 0.0019, 0.0003, 0.0001, 
              0.0000, 0.0000, 0.0001, 0.0249, 0.1146, 0.2771, 0.3030, 0.2232, 0.0345, 0.0129, 0.0069, 0.0021, 0.0005, 0.0002, 
              0.0000, 0.0000, 0.0025, 0.0361, 0.1669, 0.2498, 0.2918, 0.1523, 0.0709, 0.0151, 0.0110, 0.0025, 0.0005, 0.0006, 
              0.0000, 0.0000, 0.0008, 0.0315, 0.1945, 0.2589, 0.2298, 0.1507, 0.0695, 0.0338, 0.0169, 0.0068, 0.0011, 0.0057, 
              0.0000, 0.0009, 0.0045, 0.0270, 0.1034, 0.2297, 0.2746, 0.1989, 0.1025, 0.0373, 0.0135, 0.0059, 0.0014, 0.0003, 
              0.0000, 0.0003, 0.0113, 0.0867, 0.2102, 0.2707, 0.2177, 0.1275, 0.0505, 0.0158, 0.0057, 0.0026, 0.0008, 0.0001, 
              0.0000, 0.0001, 0.0016, 0.0132, 0.0573, 0.1626, 0.2519, 0.2463, 0.1544, 0.0687, 0.0273, 0.0129, 0.0031, 0.0007, 
              0.0000, 0.0002, 0.0062, 0.0494, 0.1504, 0.2354, 0.2326, 0.1740, 0.0886, 0.0372, 0.0152, 0.0081, 0.0023, 0.0004, 
              0.0000, 0.0002, 0.0066, 0.0680, 0.1826, 0.2377, 0.2199, 0.1591, 0.0776, 0.0302, 0.0118, 0.0049, 0.0010, 0.0003, 
              0.0000, 0.0003, 0.0089, 0.0938, 0.2407, 0.2563, 0.1986, 0.1208, 0.0511, 0.0185, 0.0072, 0.0030, 0.0006, 0.0002, 
              0.0000, 0.0000, 0.0013, 0.0398, 0.1689, 0.2397, 0.2367, 0.1648, 0.0855, 0.0375, 0.0156, 0.0078, 0.0019, 0.0005, 
              0.0000, 0.0000, 0.0002, 0.0355, 0.2012, 0.2760, 0.2643, 0.1454, 0.0508, 0.0134, 0.0084, 0.0033, 0.0008, 0.0007, 
              0.0000, 0.0000, 0.0165, 0.0684, 0.1754, 0.3141, 0.2301, 0.1310, 0.0491, 0.0109, 0.0018, 0.0023, 0.0003, 0.0001, 
              0.0002, 0.0042, 0.0143, 0.0781, 0.1804, 0.2651, 0.2135, 0.1380, 0.0650, 0.0303, 0.0074, 0.0031, 0.0004, 0.0000, 
              0.0000, 0.0000, 0.0047, 0.0578, 0.1440, 0.2488, 0.2072, 0.1758, 0.0938, 0.0526, 0.0091, 0.0029, 0.0020, 0.0014, 
              0.0001, 0.0013, 0.0055, 0.0507, 0.1716, 0.2805, 0.2189, 0.1621, 0.0736, 0.0244, 0.0074, 0.0029, 0.0006, 0.0004, 
              0.0000, 0.0000, 0.0019, 0.0286, 0.1192, 0.2413, 0.2429, 0.2053, 0.1043, 0.0369, 0.0126, 0.0054, 0.0011, 0.0004, 
              0.0000, 0.0000, 0.0015, 0.0292, 0.1216, 0.2371, 0.2501, 0.2068, 0.1013, 0.0334, 0.0122, 0.0054, 0.0011, 0.0003, 
              0.0000, 0.0003, 0.0053, 0.0413, 0.1280, 0.2502, 0.2604, 0.2003, 0.0785, 0.0191, 0.0123, 0.0041, 0.0001, 0.0000, 
              0.0000, 0.0000, 0.0022, 0.0364, 0.1438, 0.2735, 0.2700, 0.1665, 0.0728, 0.0231, 0.0080, 0.0030, 0.0006, 0.0002, 
              0.0000, 0.0000, 0.0014, 0.0309, 0.1387, 0.2712, 0.2706, 0.1773, 0.0753, 0.0232, 0.0081, 0.0028, 0.0005, 0.0002, 
              0.0001, 0.0006, 0.0050, 0.0326, 0.1207, 0.2131, 0.2270, 0.2492, 0.1023, 0.0308, 0.0126, 0.0049, 0.0009, 0.0002, 
              0.0001, 0.0008, 0.0047, 0.0312, 0.1239, 0.2279, 0.2273, 0.2303, 0.1001, 0.0335, 0.0138, 0.0053, 0.0010, 0.0003, 
              0.0002, 0.0030, 0.0116, 0.0451, 0.1400, 0.2383, 0.2168, 0.2058, 0.0906, 0.0310, 0.0125, 0.0040, 0.0006, 0.0004, 
              0.0000, 0.0002, 0.0043, 0.0445, 0.1590, 0.2694, 0.2141, 0.1861, 0.0795, 0.0276, 0.0111, 0.0032, 0.0005, 0.0005, 
              0.0000, 0.0000, 0.0018, 0.0192, 0.1170, 0.2723, 0.2022, 0.2128, 0.1052, 0.0343, 0.0215, 0.0080, 0.0003, 0.0052, 
              0.0002, 0.0005, 0.0036, 0.0420, 0.1184, 0.2682, 0.2044, 0.1964, 0.1006, 0.0467, 0.0081, 0.0107, 0.0001, 0.0000, 
              0.0000, 0.0000, 0.0007, 0.0298, 0.0748, 0.1946, 0.1922, 0.2488, 0.1644, 0.0462, 0.0338, 0.0111, 0.0037, 0.0000, 
              0.0001, 0.0043, 0.0055, 0.0306, 0.1554, 0.2243, 0.2348, 0.1499, 0.1292, 0.0502, 0.0125, 0.0033, 0.0000, 0.0000, 
              0.0015, 0.0054, 0.0081, 0.0229, 0.1035, 0.2331, 0.2405, 0.2004, 0.1220, 0.0415, 0.0154, 0.0047, 0.0007, 0.0004, 
              0.0005, 0.0033, 0.0090, 0.0373, 0.1335, 0.2453, 0.2290, 0.1962, 0.0982, 0.0316, 0.0116, 0.0037, 0.0007, 0.0002, 
              0.0042, 0.0199, 0.0762, 0.1339, 0.1793, 0.1954, 0.1538, 0.1396, 0.0636, 0.0218, 0.0083, 0.0032, 0.0007, 0.0001, 
              0.0005, 0.0190, 0.0742, 0.1339, 0.1756, 0.1976, 0.1550, 0.1556, 0.0600, 0.0186, 0.0068, 0.0025, 0.0006, 0.0001, 
              0.0003, 0.0093, 0.0538, 0.1721, 0.2641, 0.2117, 0.1527, 0.0849, 0.0338, 0.0112, 0.0042, 0.0015, 0.0003, 0.0001, 
              0.0003, 0.0065, 0.0292, 0.1256, 0.2644, 0.2310, 0.1805, 0.0974, 0.0414, 0.0149, 0.0058, 0.0023, 0.0004, 0.0002, 
              0.0002, 0.0026, 0.0154, 0.0942, 0.2112, 0.2654, 0.2182, 0.1253, 0.0472, 0.0131, 0.0046, 0.0017, 0.0003, 0.0007, 
              0.0002, 0.0065, 0.0182, 0.0465, 0.1212, 0.1892, 0.1724, 0.2332, 0.1297, 0.0500, 0.0222, 0.0088, 0.0016, 0.0003, 
              0.0003, 0.0034, 0.0147, 0.0519, 0.1433, 0.2238, 0.1964, 0.2116, 0.1003, 0.0342, 0.0140, 0.0050, 0.0008, 0.0002), 
    .Dim = c(14,44))
data$P_fishery <- t(data$P_fishery)    
data$P_fishery <- data$P_fishery / repvec(apply(data$P_fishery, 1, sum), ncol = ncol(data$P_fishery))
dimnames(data$P_fishery) <- list(year = 1973:2016, age = 1:14)

# Proportion of matures by year and size group (Calculated from RV length frequencies):
data$P_fishery_length <- cbind(c(0.0001,0.0486,0.1158,0.2215,0.2099,0.3839,0.0127,0.0098,0.0118,8e-04,0.0335,
                            0.1724,0.0156,0.0722,0.1183,0.1477,0.0135,2e-04,0.0464,0.0435,0.02,0.041,
                            0.0203,0.0181,0.0199,0.0268,0.0157,0.0719,0.0594,0.1163,0.1206,0.0593,0.1021,
                            0.0766,0.1069,0.0759,0.109,0.429,0.4124,0.3347,0.1808,0.1559,0.102,0.100),
                          c(0.9999,0.9514,0.8842,0.7785,0.7901,0.6161,0.9873,0.9902,0.9882,0.9992,0.9665,
                            0.8276,0.9844,0.9278,0.8817,0.8523,0.9865,0.9998,0.9536,0.9565,0.98,0.959,
                            0.9797,0.9819,0.9801,0.9732,0.9843,0.9281,0.9406,0.8837,0.8794,0.9407,0.8979,
                            0.9234,0.8931,0.9241,0.891,0.571,0.5876,0.6653,0.8192,0.8441,0.898,0.900))
rownames(data$P_fishery_length) <- 1973:2016
data$P_fishery_length <- data$P_fishery_length[as.numeric(rownames(data$P_fishery_length)) %in% data$years,]
colnames(data$P_fishery_length) <- 1:2

# Individual weight-at-age (in kg) by age and year:
data$weight_at_age = c(0.0777, 0.0897, 0.1212, 0.1946, 0.2534, 0.3077, 0.3567, 0.4039, 0.4696, 0.5480, 0.5791, 0.6768, 0.7698, 0.6284, 
                       0.0384, 0.0620, 0.1157, 0.2016, 0.2651, 0.3276, 0.3831, 0.4326, 0.4959, 0.5684, 0.5978, 0.6964, 0.8012, 0.6462, 
                       0.0179, 0.0486, 0.0942, 0.1525, 0.2149, 0.2908, 0.3602, 0.4217, 0.4990, 0.5835, 0.6162, 0.7211, 0.8309, 0.6683, 
                       0.0290, 0.0368, 0.0610, 0.1869, 0.2778, 0.3646, 0.4425, 0.5028, 0.5659, 0.6237, 0.6438, 0.7008, 0.7504, 0.6734, 
                       0.0565, 0.0665, 0.0968, 0.1809, 0.2295, 0.3156, 0.4044, 0.4671, 0.5697, 0.7171, 0.8058, 1.0039, 1.1662, 0.9095, 
                       0.0523, 0.0784, 0.1181, 0.1689, 0.2232, 0.2992, 0.3694, 0.4262, 0.4928, 0.5765, 0.6190, 0.8165, 1.0720, 0.7055, 
                       0.0459, 0.0635, 0.0932, 0.1293, 0.1789, 0.2395, 0.3155, 0.3823, 0.3574, 0.5483, 0.5854, 0.6934, 0.7760, 0.6421, 
                       0.0407, 0.0624, 0.1623, 0.1420, 0.1925, 0.2344, 0.3378, 0.3983, 0.5994, 0.5630, 0.5498, 0.7019, 0.7585, 0.6776, 
                       0.0265, 0.0421, 0.0773, 0.1140, 0.1817, 0.2497, 0.2762, 0.3396, 0.4458, 0.5816, 0.6253, 0.7375, 0.9559, 0.8185, 
                       0.0422, 0.0508, 0.0973, 0.1410, 0.1839, 0.2577, 0.3095, 0.3543, 0.4701, 0.5468, 0.5905, 0.7545, 0.8290, 0.7194, 
                       0.0184, 0.0545, 0.0787, 0.1382, 0.2095, 0.2952, 0.3359, 0.3790, 0.4317, 0.5419, 0.5758, 0.7529, 0.8173, 0.7201, 
                       0.0357, 0.0658, 0.1137, 0.1756, 0.2246, 0.2722, 0.3132, 0.3497, 0.3980, 0.4576, 0.4837, 0.5819, 0.7065, 0.5296, 
                       0.0334, 0.0527, 0.0768, 0.1187, 0.1654, 0.2250, 0.2858, 0.3414, 0.4080, 0.4725, 0.4943, 0.5518, 0.5951, 0.5252, 
                       0.0119, 0.0424, 0.0767, 0.1212, 0.1689, 0.2417, 0.3345, 0.4183, 0.5022, 0.5703, 0.5926, 0.6549, 0.7101, 0.6251, 
                       0.0252, 0.0471, 0.0753, 0.1400, 0.1962, 0.2541, 0.3095, 0.3636, 0.4395, 0.5313, 0.5687, 0.6922, 0.8226, 0.6296, 
                       0.0208, 0.0527, 0.0827, 0.1319, 0.1910, 0.2656, 0.3338, 0.3963, 0.4798, 0.5734, 0.6087, 0.7151, 0.8160, 0.6630, 
                       0.0178, 0.0490, 0.0759, 0.1153, 0.1608, 0.2224, 0.2884, 0.3523, 0.4328, 0.5122, 0.5393, 0.6117, 0.6688, 0.5779, 
                       0.0204, 0.0488, 0.0825, 0.1332, 0.1840, 0.2470, 0.3079, 0.3601, 0.4226, 0.4895, 0.5155, 0.5990, 0.6860, 0.5570, 
                       0.0337, 0.0589, 0.0907, 0.1372, 0.1811, 0.2310, 0.2830, 0.3414, 0.4355, 0.5510, 0.5935, 0.7075, 0.7942, 0.6546, 
                       0.0185, 0.0394, 0.0904, 0.1326, 0.1805, 0.2403, 0.2763, 0.3144, 0.3822, 0.7108, 0.5595, 0.8607, 0.9807, 0.8015, 
                       0.0662, 0.0916, 0.1143, 0.1374, 0.1611, 0.2076, 0.2322, 0.2355, 0.2740, 0.3108, 0.3679, 0.3247, 0.3751, 0.3699, 
                       0.0294, 0.0816, 0.1011, 0.1482, 0.1821, 0.2350, 0.2659, 0.3655, 0.4090, 0.5460, 0.5629, 0.7629, 0.9196, 0.8971, 
                       0.0228, 0.0638, 0.1038, 0.1473, 0.1765, 0.2215, 0.2618, 0.2966, 0.3273, 0.3649, 0.4624, 0.5288, 0.4907, 0.4458, 
                       0.0128, 0.0337, 0.0681, 0.1322, 0.1863, 0.2417, 0.2929, 0.3403, 0.4012, 0.4653, 0.4884, 0.5529, 0.6057, 0.5223, 
                       0.0133, 0.0328, 0.0564, 0.0997, 0.1583, 0.2325, 0.2946, 0.3466, 0.4155, 0.5067, 0.5480, 0.6942, 0.8381, 0.6192, 
                       0.0131, 0.0343, 0.0620, 0.1111, 0.1626, 0.2217, 0.2779, 0.3324, 0.4110, 0.5075, 0.5451, 0.6543, 0.7449, 0.6021, 
                       0.0115, 0.0374, 0.0557, 0.1037, 0.1429, 0.1978, 0.2607, 0.3179, 0.4153, 0.4369, 0.3990, 0.3980, 0.7303, 0.6951, 
                       0.0202, 0.0497, 0.0727, 0.1080, 0.1459, 0.1995, 0.2612, 0.3214, 0.3966, 0.4753, 0.5049, 0.5957, 0.6825, 0.5509, 
                       0.0196, 0.0417, 0.0694, 0.1159, 0.1603, 0.2096, 0.2561, 0.3005, 0.3604, 0.4275, 0.4530, 0.5298, 0.6003, 0.4922, 
                       0.0168, 0.0361, 0.0576, 0.0972, 0.1401, 0.1885, 0.2332, 0.2749, 0.3326, 0.4030, 0.4313, 0.5180, 0.5930, 0.4758, 
                       0.0211, 0.0390, 0.0615, 0.1004, 0.1460, 0.1987, 0.2414, 0.2778, 0.3291, 0.4016, 0.4354, 0.5575, 0.6830, 0.4944, 
                       0.0154, 0.0352, 0.0566, 0.0959, 0.1508, 0.2234, 0.2855, 0.3358, 0.3957, 0.4587, 0.4821, 0.5508, 0.6112, 0.5175, 
                       0.0174, 0.0333, 0.0538, 0.0905, 0.1381, 0.1999, 0.2513, 0.2926, 0.3434, 0.4009, 0.4237, 0.4952, 0.5616, 0.4599, 
                       0.0092, 0.0331, 0.0572, 0.0900, 0.1369, 0.1933, 0.2265, 0.2537, 0.3159, 0.3158, 0.4026, 0.4556, 0.6913, 0.3090, 
                       0.0149, 0.0233, 0.0379, 0.0755, 0.1290, 0.1786, 0.2134, 0.2584, 0.2936, 0.3343, 0.4339, 0.3521, 0.9461, 0.6841, 
                       0.0084, 0.0268, 0.0431, 0.0778, 0.1180, 0.1697, 0.2066, 0.2552, 0.3013, 0.3731, 0.3922, 0.4526, 0.4644, 0.7542, 
                       0.0104, 0.0320, 0.0465, 0.0743, 0.1245, 0.1580, 0.2345, 0.2689, 0.3299, 0.4283, 0.4266, 0.5566, 0.7570, 0.7283, 
                       0.0195, 0.0313, 0.0497, 0.0871, 0.1284, 0.1748, 0.2161, 0.2537, 0.3042, 0.3645, 0.3891, 0.4701, 0.5540, 0.4292, 
                       0.0216, 0.0335, 0.0486, 0.0802, 0.1271, 0.1837, 0.2297, 0.2666, 0.3089, 0.3497, 0.3638, 0.4021, 0.4331, 0.3841, 
                       0.0200, 0.0402, 0.0585, 0.0889, 0.1239, 0.1698, 0.2161, 0.2607, 0.3201, 0.3838, 0.4064, 0.4673, 0.5129, 0.4390, 
                       0.0175, 0.0386, 0.0621, 0.0956, 0.1336, 0.1760, 0.2116, 0.2418, 0.2792, 0.3186, 0.3329, 0.3734, 0.4064, 0.3542, 
                       0.0176, 0.0364, 0.0633, 0.1077, 0.1516, 0.2009, 0.2453, 0.2853, 0.3390, 0.4026, 0.4274, 0.5005, 0.5603, 0.4654, 
                       0.0064, 0.0375, 0.0607, 0.1086, 0.1737, 0.2364, 0.2762, 0.3041, 0.3352, 0.3678, 0.3803, 0.4198, 0.4585, 0.4002, 
                       0.0173, 0.0326, 0.0539, 0.0969, 0.1436, 0.1991, 0.2505, 0.2955, 0.3529, 0.4264, 0.4607, 0.5916, 0.7304, 0.5227, 
                       0.0241, 0.0412, 0.0588, 0.0984, 0.1476, 0.2048, 0.2538, 0.2947, 0.3456, 0.4039, 0.4274, 0.5041, 0.5821, 0.4655, 
                       0.0155, 0.0381, 0.0612, 0.0942, 0.1285, 0.1753, 0.2253, 0.2703, 0.3229, 0.3735, 0.3909, 0.4382, 0.4748, 0.4161)
dim(data$weight_at_age) <- c(14, 46)
data$weight_at_age <- t(data$weight_at_age)
dimnames(data$weight_at_age) <- list(year = 1971:2016, age = 1:14)
data$weight_at_age <- data$weight_at_age[as.numeric(rownames(data$weight_at_age)) %in% data$years,]

# Proportion of matures-at-age by year:
data$maturity_at_age <- c(0.0344, 0.0664, 0.1945, 0.5332, 0.7512, 0.8699, 0.9248, 0.9530, 0.9739, 0.9864, 0.9894, 0.9951, 0.9978, 0.9928, 
                          0.0268, 0.0864, 0.3024, 0.6438, 0.8112, 0.9001, 0.9406, 0.9613, 0.9766, 0.9861, 0.9886, 0.9937, 0.9965, 0.9915, 
                          0.0063, 0.0581, 0.2131, 0.4717, 0.6890, 0.8465, 0.9200, 0.9538, 0.9757, 0.9873, 0.9900, 0.9950, 0.9974, 0.9930, 
                          0.0564, 0.0846, 0.1961, 0.6940, 0.8875, 0.9494, 0.9738, 0.9845, 0.9910, 0.9944, 0.9952, 0.9969, 0.9978, 0.9962, 
                          0.2105, 0.2757, 0.4482, 0.7953, 0.8694, 0.9452, 0.9693, 0.9797, 0.9883, 0.9942, 0.9955, 0.9983, 0.9993, 0.9972, 
                          0.1238, 0.2690, 0.4944, 0.7124, 0.8347, 0.9213, 0.9613, 0.9783, 0.9885, 0.9936, 0.9949, 0.9975, 0.9990, 0.9964, 
                          0.1115, 0.2050, 0.3818, 0.5624, 0.7401, 0.8496, 0.9403, 0.9665, 0.9356, 0.9891, 0.9913, 0.9956, 0.9977, 0.9938, 
                          0.1000, 0.2233, 0.6707, 0.6698, 0.8181, 0.8799, 0.9373, 0.9503, 0.9966, 0.9938, 0.9880, 0.9983, 0.9987, 0.9981, 
                          0.0290, 0.0792, 0.2566, 0.4656, 0.7224, 0.8573, 0.8686, 0.9211, 0.9512, 0.9890, 0.9929, 0.9974, 0.9995, 0.9991, 
                          0.0540, 0.0779, 0.3041, 0.5286, 0.6977, 0.8419, 0.8992, 0.9439, 0.9767, 0.9853, 0.9929, 0.9979, 0.9985, 0.9975, 
                          0.0183, 0.1191, 0.2194, 0.5014, 0.7521, 0.8935, 0.9249, 0.9467, 0.9651, 0.9381, 0.9914, 0.9976, 0.9983, 0.9971, 
                          0.1142, 0.2681, 0.4977, 0.7129, 0.8206, 0.8844, 0.9175, 0.9371, 0.9543, 0.9674, 0.9714, 0.9813, 0.9883, 0.9768, 
                          0.3275, 0.4760, 0.6144, 0.7621, 0.8565, 0.9179, 0.9500, 0.9671, 0.9796, 0.9870, 0.9889, 0.9926, 0.9946, 0.9910, 
                          0.1682, 0.4882, 0.7173, 0.8560, 0.9225, 0.9620, 0.9817, 0.9907, 0.9957, 0.9977, 0.9981, 0.9988, 0.9992, 0.9985, 
                          0.2022, 0.3883, 0.5635, 0.8029, 0.9057, 0.9507, 0.9703, 0.9805, 0.9883, 0.9933, 0.9945, 0.9971, 0.9985, 0.9961, 
                          0.1775, 0.4388, 0.6189, 0.7889, 0.8868, 0.9457, 0.9704, 0.9816, 0.9893, 0.9938, 0.9949, 0.9972, 0.9983, 0.9963, 
                          0.1622, 0.4167, 0.5841, 0.7384, 0.8383, 0.9091, 0.9464, 0.9662, 0.9805, 0.9886, 0.9906, 0.9943, 0.9961, 0.9928, 
                          0.1422, 0.3512, 0.5555, 0.7492, 0.8543, 0.9193, 0.9518, 0.9684, 0.9802, 0.9873, 0.9892, 0.9931, 0.9955, 0.9914, 
                          0.2223, 0.4060, 0.5888, 0.7596, 0.8537, 0.9120, 0.9428, 0.9610, 0.9769, 0.9876, 0.9903, 0.9953, 0.9975, 0.9934, 
                          0.2305, 0.4134, 0.7045, 0.8260, 0.8990, 0.9486, 0.9551, 0.9705, 0.9812, 0.9971, 0.9928, 0.9982, 0.9988, 0.9979, 
                          0.4218, 0.6044, 0.7209, 0.8162, 0.8862, 0.9556, 0.9681, 0.9641, 0.9830, 0.9936, 0.9979, 0.9956, 0.9982, 0.9980, 
                          0.3848, 0.7075, 0.8117, 0.9050, 0.9391, 0.9685, 0.9710, 0.9885, 0.9898, 0.9980, 0.9981, 0.9996, 0.9998, 0.9998, 
                          0.1261, 0.4433, 0.7136, 0.8555, 0.9064, 0.9586, 0.9767, 0.9839, 0.9882, 0.9931, 0.9987, 0.9993, 0.9991, 0.9991, 
                          0.1046, 0.2936, 0.5392, 0.8025, 0.9048, 0.9505, 0.9699, 0.9799, 0.9874, 0.9922, 0.9934, 0.9959, 0.9973, 0.9949, 
                          0.0664, 0.2014, 0.3770, 0.6173, 0.7980, 0.9115, 0.9552, 0.9730, 0.9844, 0.9909, 0.9926, 0.9963, 0.9982, 0.9947, 
                          0.0534, 0.1914, 0.3970, 0.6689, 0.8294, 0.9175, 0.9550, 0.9727, 0.9851, 0.9922, 0.9939, 0.9971, 0.9986, 0.9959, 
                          0.0760, 0.2868, 0.4382, 0.7066, 0.8240, 0.9097, 0.9578, 0.9805, 0.9913, 0.9893, 0.9900, 0.9896, 0.9993, 0.9991, 
                          0.1541, 0.4026, 0.5620, 0.7276, 0.8312, 0.9045, 0.9455, 0.9675, 0.9827, 0.9907, 0.9925, 0.9959, 0.9976, 0.9945, 
                          0.1545, 0.3469, 0.5479, 0.7610, 0.8687, 0.9286, 0.9563, 0.9708, 0.9820, 0.9892, 0.9910, 0.9948, 0.9969, 0.9932, 
                          0.1477, 0.3435, 0.5267, 0.7377, 0.8615, 0.9294, 0.9589, 0.9734, 0.9840, 0.9906, 0.9923, 0.9959, 0.9977, 0.9944, 
                          0.1586, 0.3315, 0.5220, 0.7317, 0.8587, 0.9329, 0.9628, 0.9759, 0.9850, 0.9908, 0.9925, 0.9961, 0.9981, 0.9945, 
                          0.0897, 0.2689, 0.4613, 0.6952, 0.8552, 0.9452, 0.9760, 0.9871, 0.9933, 0.9963, 0.9970, 0.9983, 0.9990, 0.9978, 
                          0.0836, 0.2266, 0.4299, 0.6867, 0.8492, 0.9425, 0.9751, 0.9868, 0.9932, 0.9963, 0.9970, 0.9985, 0.9992, 0.9979, 
                          0.0398, 0.2645, 0.4948, 0.7304, 0.8803, 0.9548, 0.9681, 0.9811, 0.9915, 0.9665, 0.9986, 0.9991, 0.9999, 0.9966, 
                          0.1172, 0.2124, 0.3741, 0.6421, 0.8801, 0.9505, 0.9709, 0.9847, 0.9923, 0.9957, 0.9985, 0.9959, 0.9999, 0.9997, 
                          0.0516, 0.2305, 0.3988, 0.6561, 0.8399, 0.9266, 0.9585, 0.9841, 0.9870, 0.9947, 0.9975, 0.9982, 0.9982, 0.9999, 
                          0.0497, 0.2119, 0.3955, 0.6065, 0.8164, 0.8933, 0.9432, 0.9694, 0.9813, 0.9978, 0.9892, 0.9995, 0.9999, 0.9999, 
                          0.1607, 0.2872, 0.4652, 0.7091, 0.8522, 0.9298, 0.9612, 0.9756, 0.9857, 0.9918, 0.9933, 0.9964, 0.9981, 0.9951, 
                          0.1864, 0.3176, 0.4659, 0.6688, 0.8329, 0.9299, 0.9648, 0.9788, 0.9874, 0.9922, 0.9934, 0.9958, 0.9971, 0.9948, 
                          0.1686, 0.3860, 0.5658, 0.7542, 0.8677, 0.9372, 0.9678, 0.9817, 0.9906, 0.9953, 0.9963, 0.9982, 0.9990, 0.9975, 
                          0.1210, 0.3594, 0.5967, 0.7920, 0.8989, 0.9559, 0.9772, 0.9861, 0.9919, 0.9952, 0.9961, 0.9977, 0.9986, 0.9970, 
                          0.1699, 0.4059, 0.6502, 0.8535, 0.9355, 0.9720, 0.9855, 0.9913, 0.9951, 0.9973, 0.9978, 0.9989, 0.9994, 0.9984, 
                          0.0484, 0.3399, 0.5490, 0.7810, 0.9155, 0.9710, 0.9857, 0.9908, 0.9939, 0.9958, 0.9962, 0.9974, 0.9981, 0.9969, 
                          0.1029, 0.2431, 0.4353, 0.7037, 0.8557, 0.9349, 0.9667, 0.9805, 0.9893, 0.9941, 0.9953, 0.9977, 0.9989, 0.9967, 
                          0.1603, 0.3097, 0.4605, 0.6897, 0.8467, 0.9321, 0.9648, 0.9787, 0.9876, 0.9927, 0.9940, 0.9966, 0.9980, 0.9955, 
                          0.0886, 0.2775, 0.4727, 0.6776, 0.8044, 0.8928, 0.9400, 0.9641, 0.9802, 0.9888, 0.9908, 0.9945, 0.9964, 0.9930)
dim(data$maturity_at_age) <- c(14, 46)
data$maturity_at_age <- t(data$maturity_at_age)
dimnames(data$maturity_at_age) <- list(year = 1971:2016, age = 1:14)
data$maturity_at_age <- data$maturity_at_age[as.numeric(rownames(data$maturity_at_age)) %in% data$years,]

# Define remaining variables:
data$ages <- as.numeric(colnames(data$weight_at_age))
data$M_block <- floor((data$years - min(data$years)) / 5) + 1 # Mapping of mortality block by year.
data$n_M <- length(unique(data$M_block))      # Number of mortality blocks to be used.
data$n_age <- length(data$ages)
data$sage = min(data$ages)     # Start age. 
data$lage = max(data$ages)     # Last age.
data$splitAge = 5              # Index (C++ indexing) of split age, used to divide length groups.
data$a1F1 = 0                  # Index of a1F1 a2F1 first and last ages for F group 1
data$a2F1 = data$splitAge-1  
data$a1F2 = data$splitAge+1    # Index a1F2 a2F2 first and last ages for F group 2
data$a2F2 = length(data$ages)-1
data$n_fishery = 1             # Number of fisheries used in the analysis.
data$n_rv = 1              # Number of survey indices.
data$n_length = 2              # Number of length groups.
data$S_rv_block = rep(1, data$n_year) # Index vector for mapping survey to selectivity function(s).
data$S_fishery_block = rep(2, data$n_year) # Index vector for mapping fishery to selectivity function(s).
data$n_S = length(unique(c(data$S_rv_block, data$S_fishery_block))) # Number of selectivity functions to be used.
data$frac_rv = 0.71   # Survey timing as fraction of the year (i.e. 9/12 for September).
data$baranovIter = 10 # Number of Baranov iterations.
data$priorSD_R = 0.2  # Standard deviation for recruitment.
data$prior_Minit = c(0.8, 0.3)       # Prior for initial mortality.
data$Minit_priorSD = c(0.05, 0.025)  # Prior for initial mortality standard error.
data$log_q_prior = -1.14             # Catchability prior.
data$log_q_priorSD = 0.2             # Catchability prior standard error.
data$loglike_weight = c(1.0, 1.0, 1.0) # Likelihood weights.
data$init_tauLgrp = 0.5  
             
